(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{880:function(t,e,r){var n,i,o;i=[],void 0===(o="function"==typeof(n=function(){"use strict";var u=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var l=i.get;return void 0!==l?l.call(n):void 0},l=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function v(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){return t.length?t+e:t}function c(r){for(var t=arguments.length,e=Array(1<t?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];if(r&&e){var i=function(e){"object"===(void 0===e?"undefined":f(e))&&Object.getOwnPropertyNames(e).forEach(function(t){r[t]=e[t]})},o=!0,l=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var c=u.value;i(c)}}catch(t){l=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(l)throw a}}}return r}function i(t){return t&&t.constructor.prototype===Object.prototype}function d(t){return t&&t.constructor.prototype===Array.prototype}function r(t,e,r){var n=void 0===e?"undefined":f(e);if("function"!==n&&"string"!==n)throw new Error("type must be a class constructor or string");if("function"!=typeof r)throw new Error("handler must be a function");var i=!0,o=!1,l=void 0;try{for(var a,u=t[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var s=a.value;if(s.type===e)return void(s.handler=r)}}catch(t){o=!0,l=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw l}}t.push({type:e,handler:r})}function o(t,e,r){return n(t,e)||n(t,r)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];if((void 0===t?"undefined":f(t))===n.type||"string"!=typeof n.type&&t instanceof n.type)return n.handler}}function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,p={isSquelBuilder:function(t){return t&&!!t._toParamString}},s=function(t){return!p.isSquelBuilder(t)||!t.options.rawNesting};p.DefaultQueryBuilderOptions={autoQuoteTableNames:!1,autoQuoteFieldNames:!1,autoQuoteAliasNames:!0,useAsForTableAliasNames:!1,nameQuoteCharacter:"`",tableAliasQuoteCharacter:"`",fieldAliasQuoteCharacter:'"',valueHandlers:[],parameterCharacter:"?",numberedParameters:!1,numberedParametersPrefix:"$",numberedParametersStartAt:1,replaceSingleQuotes:!1,singleQuoteReplacement:"''",separator:" ",stringFormatter:null,rawNesting:!1},p.globalValueHandlers=[],p.registerValueHandler=function(t,e){r(p.globalValueHandlers,t,e)},p.Cloneable=function(){function t(){_(this,t)}return l(t,[{key:"clone",value:function(){var t=new this.constructor;return c(t,function e(r){if(!r)return r;if("function"==typeof r.clone)return r.clone();if(i(r)||d(r)){var n=new r.constructor;return Object.getOwnPropertyNames(r).forEach(function(t){"function"!=typeof r[t]&&(n[t]=e(r[t]))}),n}return JSON.parse(JSON.stringify(r))}(c({},this)))}}]),t}(),p.BaseBuilder=function(t){function n(t){_(this,n);var e=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),r=JSON.parse(JSON.stringify(p.DefaultQueryBuilderOptions));return["stringFormatter"].forEach(function(t){r[t]=p.DefaultQueryBuilderOptions[t]}),e.options=c({},r,t),e}return a(n,t),l(n,[{key:"registerValueHandler",value:function(t,e){return r(this.options.valueHandlers,t,e),this}},{key:"_sanitizeExpression",value:function(t){if(!p.isSquelBuilder(t)&&"string"!=typeof t)throw new Error("expression must be a stringÂ or builder instance");return t}},{key:"_sanitizeName",value:function(t,e){if("string"!=typeof t)throw new Error(e+" must be a string");return t}},{key:"_sanitizeField",value:function(t){return p.isSquelBuilder(t)||(t=this._sanitizeName(t,"field name")),t}},{key:"_sanitizeBaseBuilder",value:function(t){if(p.isSquelBuilder(t))return t;throw new Error("must be a builder instance")}},{key:"_sanitizeTable",value:function(t){if("string"!=typeof t)try{t=this._sanitizeBaseBuilder(t)}catch(t){throw new Error("table name must be a string or a builder")}else t=this._sanitizeName(t,"table");return t}},{key:"_sanitizeTableAlias",value:function(t){return this._sanitizeName(t,"table alias")}},{key:"_sanitizeFieldAlias",value:function(t){return this._sanitizeName(t,"field alias")}},{key:"_sanitizeLimitOffset",value:function(t){if((t=parseInt(t))<0||isNaN(t))throw new Error("limit/offset must be >= 0");return t}},{key:"_sanitizeValue",value:function(t){var e=void 0===t?"undefined":f(t);if(null===t);else if("string"===e||"number"===e||"boolean"===e);else if(p.isSquelBuilder(t));else{var r=!!o(t,this.options.valueHandlers,p.globalValueHandlers);if(!r)throw new Error("field value must be a string, number, boolean, null or one of the registered custom value types")}return t}},{key:"_escapeValue",value:function(t){return this.options.replaceSingleQuotes&&t?t.replace(/\'/g,this.options.singleQuoteReplacement):t}},{key:"_formatTableName",value:function(t){if(this.options.autoQuoteTableNames){var e=this.options.nameQuoteCharacter;t=""+e+t+e}return t}},{key:"_formatFieldAlias",value:function(t){if(this.options.autoQuoteAliasNames){var e=this.options.fieldAliasQuoteCharacter;t=""+e+t+e}return t}},{key:"_formatTableAlias",value:function(t){if(this.options.autoQuoteAliasNames){var e=this.options.tableAliasQuoteCharacter;t=""+e+t+e}return this.options.useAsForTableAliasNames?"AS "+t:t}},{key:"_formatFieldName",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this.options.autoQuoteFieldNames){var r=this.options.nameQuoteCharacter;t=e.ignorePeriodsForFieldNameQuotes?""+r+t+r:t.split(".").map(function(t){return"*"===t?t:""+r+t+r}).join(".")}return t}},{key:"_formatCustomValue",value:function(t,e,r){var n=o(t,this.options.valueHandlers,p.globalValueHandlers);return n&&(t=n(t,e,r))&&t.rawNesting?{formatted:!0,rawNesting:!0,value:t.value}:{formatted:!!n,value:t}}},{key:"_formatValueForParamArray",value:function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return d(t)?t.map(function(t){return e._formatValueForParamArray(t,r)}):this._formatCustomValue(t,!0,r).value}},{key:"_formatValueForQueryString",value:function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this._formatCustomValue(t,!1,r),i=n.rawNesting,o=n.formatted,l=n.value;if(o)return i?l:this._applyNestingFormatting(l,s(t));if(d(l))l=l.map(function(t){return e._formatValueForQueryString(t)}),l=this._applyNestingFormatting(l.join(", "),s(l));else{var a=void 0===l?"undefined":f(l);if(null===l)l="NULL";else if("boolean"===a)l=l?"TRUE":"FALSE";else if(p.isSquelBuilder(l))l=this._applyNestingFormatting(l.toString(),s(l));else if("number"!==a){if("string"===a&&this.options.stringFormatter)return this.options.stringFormatter(l);if(r.dontQuote)l=""+l;else{var u=this._escapeValue(l);l="'"+u+"'"}}}return l}},{key:"_applyNestingFormatting",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(t&&"string"==typeof t&&e&&!this.options.rawNesting){var r="("===t.charAt(0)&&")"===t.charAt(t.length-1);if(r)for(var n=0,i=1;t.length-1>++n;){var o=t.charAt(n);if("("===o)i++;else if(")"===o&&--i<1){r=!1;break}}r||(t="("+t+")")}return t}},{key:"_buildString",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=r.nested,i=r.buildParameterized,o=r.formattingOptions;e=e||[],t=t||"";for(var l="",a=-1,u=[],s=this.options.parameterCharacter,c=0;t.length>c;)if(t.substr(c,s.length)===s){var f=e[++a];if(i)if(p.isSquelBuilder(f)){var h=f._toParamString({buildParameterized:i,nested:!0});l+=h.text,h.values.forEach(function(t){return u.push(t)})}else if(d(f=this._formatValueForParamArray(f,o))){var v=f.map(function(){return s}).join(", ");l+="("+v+")",f.forEach(function(t){return u.push(t)})}else l+=s,u.push(f);else l+=this._formatValueForQueryString(f,o);c+=s.length}else l+=t.charAt(c),c++;return{text:this._applyNestingFormatting(l,!!n),values:u}}},{key:"_buildManyStrings",value:function(t,e){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=[],i=[],o=0;t.length>o;++o){var l=t[o],a=e[o],u=this._buildString(l,a,{buildParameterized:r.buildParameterized,nested:!1}),s=u.text,c=u.values;n.push(s),c.forEach(function(t){return i.push(t)})}return{text:(n=n.join(this.options.separator)).length?this._applyNestingFormatting(n,!!r.nested):"",values:i}}},{key:"_toParamString",value:function(t){throw new Error("Not yet implemented")}},{key:"toString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._toParamString(t).text}},{key:"toParam",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._toParamString(c({},t,{buildParameterized:!0}))}}]),n}(p.Cloneable),p.Expression=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._nodes=[],e}return a(r,t),l(r,[{key:"and",value:function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t=this._sanitizeExpression(t),this._nodes.push({type:"AND",expr:t,para:r}),this}},{key:"or",value:function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t=this._sanitizeExpression(t),this._nodes.push({type:"OR",expr:t,para:r}),this}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=[],r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._nodes[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.type,c=u.expr,f=u.para,h=p.isSquelBuilder(c)?c._toParamString({buildParameterized:t.buildParameterized,nested:!0}):this._buildString(c,f,{buildParameterized:t.buildParameterized}),v=h.text,_=h.values;e.length&&e.push(s),e.push(v),_.forEach(function(t){return r.push(t)})}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return e=e.join(" "),{text:this._applyNestingFormatting(e,!!t.nested),values:r}}}]),r}(p.BaseBuilder),p.Case=function(t){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_(this,n);var r=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return i(t)&&(e=t,t=null),t&&(r._fieldName=r._sanitizeField(t)),r.options=c({},p.DefaultQueryBuilderOptions,e),r._cases=[],r._elseValue=null,r}return a(n,t),l(n,[{key:"when",value:function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this._cases.unshift({expression:t,values:r||[]}),this}},{key:"then",value:function(t){if(0==this._cases.length)throw new Error("when() needs to be called first");return this._cases[0].result=t,this}},{key:"else",value:function(t){return this._elseValue=t,this}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._cases[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.expression,c=u.values,f=u.result;e=y(e," ");var h=this._buildString(s,c,{buildParameterized:t.buildParameterized,nested:!0});e+="WHEN "+h.text+" THEN "+this._formatValueForQueryString(f),h.values.forEach(function(t){return r.push(t)})}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return{text:e=e.length?(e+=" ELSE "+this._formatValueForQueryString(this._elseValue)+" END",this._fieldName&&(e=this._fieldName+" "+e),"CASE "+e):this._formatValueForQueryString(this._elseValue),values:r}}}]),n}(p.BaseBuilder),p.Block=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),l(e,[{key:"exposedMethods",value:function(){for(var e={},r=this;r;)Object.getOwnPropertyNames(r).forEach(function(t){"constructor"===t||"function"!=typeof r[t]||"_"===t.charAt(0)||p.Block.prototype[t]||(e[t]=r[t])}),r=Object.getPrototypeOf(r);return e}}]),e}(p.BaseBuilder),p.StringBlock=function(t){function n(t,e){_(this,n);var r=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return r._str=e,r}return a(n,t),l(n,[{key:"_toParamString",value:function(){return 0<arguments.length&&void 0!==arguments[0]&&arguments[0],{text:this._str,values:[]}}}]),n}(p.Block),p.FunctionBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._strings=[],e._values=[],e}return a(r,t),l(r,[{key:"function",value:function(t){this._strings.push(t);for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._values.push(r)}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._buildManyStrings(this._strings,this._values,t)}}]),r}(p.Block),p.registerValueHandler(p.FunctionBlock,function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e?t.toParam():t.toString()}),p.AbstractTableBlock=function(t){function n(t,e){_(this,n);var r=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return r._tables=[],r}return a(n,t),l(n,[{key:"_table",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e=e?this._sanitizeTableAlias(e):e,t=this._sanitizeTable(t),this.options.singleTable&&(this._tables=[]),this._tables.push({table:t,alias:e})}},{key:"_hasTable",value:function(){return 0<this._tables.length}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[];if(this._hasTable()){var n=!0,i=!1,o=void 0;try{for(var l,a=this._tables[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.table,c=u.alias;e=y(e,", ");var f=void 0;if(p.isSquelBuilder(s)){var h=s._toParamString({buildParameterized:t.buildParameterized,nested:!0}),v=h.text,_=h.values;f=v,_.forEach(function(t){return r.push(t)})}else f=this._formatTableName(s);c&&(f+=" "+this._formatTableAlias(c)),e+=f}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}this.options.prefix&&(e=this.options.prefix+" "+e)}return{text:e,values:r}}}]),n}(p.Block),p.TargetTableBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"target",value:function(t){this._table(t)}}]),e}(p.AbstractTableBlock),p.UpdateTableBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"table",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._table(t,e)}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this._hasTable())throw new Error("table() needs to be called");return u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_toParamString",this).call(this,t)}}]),e}(p.AbstractTableBlock),p.FromTableBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{prefix:"FROM"})))}return a(e,t),l(e,[{key:"from",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._table(t,e)}}]),e}(p.AbstractTableBlock),p.IntoTableBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{prefix:"INTO",singleTable:!0})))}return a(e,t),l(e,[{key:"into",value:function(t){this._table(t)}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this._hasTable())throw new Error("into() needs to be called");return u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_toParamString",this).call(this,t)}}]),e}(p.AbstractTableBlock),p.GetFieldBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._fields=[],e}return a(r,t),l(r,[{key:"fields",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(d(t)){var r=!0,n=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var a=o.value;this.field(a,null,e)}}catch(t){n=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(n)throw i}}}else for(var u in t){var s=t[u];this.field(u,s,e)}}},{key:"field",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};r=r?this._sanitizeFieldAlias(r):r,e=this._sanitizeField(e);var n=this._fields.filter(function(t){return t.name===e&&t.alias===r});if(n.length)return this;this._fields.push({name:e,alias:r,options:t})}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.queryBuilder,r=t.buildParameterized,n="",i=[],o=!0,l=!1,a=void 0;try{for(var u,s=this._fields[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var c=u.value;n=y(n,", ");var f=c.name,h=c.alias,v=c.options;if("string"==typeof f)n+=this._formatFieldName(f,v);else{var _=f._toParamString({nested:!0,buildParameterized:r});n+=_.text,_.values.forEach(function(t){return i.push(t)})}h&&(n+=" AS "+this._formatFieldAlias(h))}}catch(t){l=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(l)throw a}}if(!n.length){var d=e&&e.getBlock(p.FromTableBlock);d&&d._hasTable()&&(n="*")}return{text:n,values:i}}}]),r}(p.Block),p.AbstractSetFieldBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._reset(),e}return a(r,t),l(r,[{key:"_reset",value:function(){this._fields=[],this._values=[[]],this._valueOptions=[[]]}},{key:"_set",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(1<this._values.length)throw new Error("Cannot set multiple rows of fields this way.");void 0!==e&&(e=this._sanitizeValue(e)),t=this._sanitizeField(t);var n=this._fields.indexOf(t);-1===n&&(this._fields.push(t),n=this._fields.length-1),this._values[0][n]=e,this._valueOptions[0][n]=r}},{key:"_setFields",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("object"!==(void 0===t?"undefined":f(t)))throw new Error("Expected an object but got "+(void 0===t?"undefined":f(t)));for(var r in t)this._set(r,t[r],e)}},{key:"_setFieldsRows",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!d(t))throw new Error("Expected an array of objects but got "+(void 0===t?"undefined":f(t)));this._reset();for(var r=0;t.length>r;++r){var n=t[r];for(var i in n){var o=n[i];i=this._sanitizeField(i),o=this._sanitizeValue(o);var l=this._fields.indexOf(i);if(0<r&&-1===l)throw new Error("All fields in subsequent rows must match the fields in the first row");-1===l&&(this._fields.push(i),l=this._fields.length-1),d(this._values[r])||(this._values[r]=[],this._valueOptions[r]=[]),this._values[r][l]=o,this._valueOptions[r][l]=e}}}}]),r}(p.Block),p.SetFieldBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"set",value:function(t,e,r){this._set(t,e,r)}},{key:"setFields",value:function(t,e){this._setFields(t,e)}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.buildParameterized;if(this._fields.length<=0)throw new Error("set() needs to be called");for(var r="",n=[],i=0;i<this._fields.length;++i){r=y(r,", ");var o=this._formatFieldName(this._fields[i]),l=this._values[0][i];o.indexOf("=")<0&&(o=o+" = "+this.options.parameterCharacter);var a=this._buildString(o,[l],{buildParameterized:e,formattingOptions:this._valueOptions[0][i]});r+=a.text,a.values.forEach(function(t){return n.push(t)})}return{text:"SET "+r,values:n}}}]),e}(p.AbstractSetFieldBlock),p.InsertFieldValueBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"set",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this._set(t,e,r)}},{key:"setFields",value:function(t,e){this._setFields(t,e)}},{key:"setFieldsRows",value:function(t,e){this._setFieldsRows(t,e)}},{key:"_toParamString",value:function(){for(var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.buildParameterized,n=this._fields.map(function(t){return e._formatFieldName(t)}).join(", "),i=[],o=[],l=0;l<this._values.length;++l){i[l]="";for(var a=0;a<this._values[l].length;++a){var u=this._buildString(this.options.parameterCharacter,[this._values[l][a]],{buildParameterized:r,formattingOptions:this._valueOptions[l][a]});u.values.forEach(function(t){return o.push(t)}),i[l]=y(i[l],", "),i[l]+=u.text}}return{text:n.length?"("+n+") VALUES ("+i.join("), (")+")":"",values:o}}}]),e}(p.AbstractSetFieldBlock),p.InsertFieldsFromQueryBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._fields=[],e._query=null,e}return a(r,t),l(r,[{key:"fromQuery",value:function(t,e){var r=this;this._fields=t.map(function(t){return r._sanitizeField(t)}),this._query=this._sanitizeBaseBuilder(e)}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[];if(this._fields.length&&this._query){var n=this._query._toParamString({buildParameterized:t.buildParameterized,nested:!0}),i=n.text,o=n.values;e="("+this._fields.join(", ")+") "+this._applyNestingFormatting(i),r=o}return{text:e,values:r}}}]),r}(p.Block),p.DistinctBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),l(e,[{key:"distinct",value:function(){this._useDistinct=!0}},{key:"_toParamString",value:function(){return{text:this._useDistinct?"DISTINCT":"",values:[]}}}]),e}(p.Block),p.GroupByBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._groups=[],e}return a(r,t),l(r,[{key:"group",value:function(t){this._groups.push(this._sanitizeField(t))}},{key:"_toParamString",value:function(){return 0<arguments.length&&void 0!==arguments[0]&&arguments[0],{text:this._groups.length?"GROUP BY "+this._groups.join(", "):"",values:[]}}}]),r}(p.Block),p.AbstractVerbSingleValueBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._value=null,e}return a(r,t),l(r,[{key:"_setValue",value:function(t){this._value=null!==t?this._sanitizeLimitOffset(t):t}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=null!==this._value?this.options.verb+" "+this.options.parameterCharacter:"",r=null!==this._value?[this._value]:[];return this._buildString(e,r,t)}}]),r}(p.Block),p.OffsetBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{verb:"OFFSET"})))}return a(e,t),l(e,[{key:"offset",value:function(t){this._setValue(t)}}]),e}(p.AbstractVerbSingleValueBlock),p.LimitBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{verb:"LIMIT"})))}return a(e,t),l(e,[{key:"limit",value:function(t){this._setValue(t)}}]),e}(p.AbstractVerbSingleValueBlock),p.AbstractConditionBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._conditions=[],e}return a(r,t),l(r,[{key:"_condition",value:function(t){t=this._sanitizeExpression(t);for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._conditions.push({expr:t,values:r||[]})}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=[],r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._conditions[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.expr,c=u.values,f=p.isSquelBuilder(s)?s._toParamString({buildParameterized:t.buildParameterized}):this._buildString(s,c,{buildParameterized:t.buildParameterized});f.text.length&&e.push(f.text),f.values.forEach(function(t){return r.push(t)})}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return e.length&&(e=e.join(") AND (")),{text:e.length?this.options.verb+" ("+e+")":"",values:r}}}]),r}(p.Block),p.WhereBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{verb:"WHERE"})))}return a(e,t),l(e,[{key:"where",value:function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._condition.apply(this,[t].concat(r))}}]),e}(p.AbstractConditionBlock),p.HavingBlock=function(t){function e(t){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c({},t,{verb:"HAVING"})))}return a(e,t),l(e,[{key:"having",value:function(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._condition.apply(this,[t].concat(r))}}]),e}(p.AbstractConditionBlock),p.OrderByBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._orders=[],e}return a(r,t),l(r,[{key:"order",value:function(t,e){t=this._sanitizeField(t),"string"!=typeof e&&(void 0===e?e="ASC":null!==e&&(e=e?"ASC":"DESC"));for(var r=arguments.length,n=Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];this._orders.push({field:t,dir:e,values:n||[]})}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._orders[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.field,c=u.dir,f=u.values;e=y(e,", ");var h=this._buildString(s,f,{buildParameterized:t.buildParameterized});e+=h.text,d(h.values)&&h.values.forEach(function(t){return r.push(t)}),null!==c&&(e+=" "+c)}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return{text:e.length?"ORDER BY "+e:"",values:r}}}]),r}(p.Block),p.JoinBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._joins=[],e}return a(r,t),l(r,[{key:"join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"INNER";t=this._sanitizeTable(t,!0),e=e?this._sanitizeTableAlias(e):e,r=r?this._sanitizeExpression(r):r,this._joins.push({type:n,table:t,alias:e,condition:r})}},{key:"left_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"LEFT")}},{key:"right_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"RIGHT")}},{key:"outer_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"OUTER")}},{key:"left_outer_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"LEFT OUTER")}},{key:"full_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"FULL")}},{key:"cross_join",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.join(t,e,r,"CROSS")}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._joins[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.type,c=u.table,f=u.alias,h=u.condition;e=y(e,this.options.separator);var v=void 0;if(p.isSquelBuilder(c)){var _=c._toParamString({buildParameterized:t.buildParameterized,nested:!0});_.values.forEach(function(t){return r.push(t)}),v=_.text}else v=this._formatTableName(c);if(e+=s+" JOIN "+v,f&&(e+=" "+this._formatTableAlias(f)),h){e+=" ON ";var d=void 0;d=p.isSquelBuilder(h)?h._toParamString({buildParameterized:t.buildParameterized}):this._buildString(h,[],{buildParameterized:t.buildParameterized}),e+=this._applyNestingFormatting(d.text),d.values.forEach(function(t){return r.push(t)})}}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return{text:e,values:r}}}]),r}(p.Block),p.UnionBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._unions=[],e}return a(r,t),l(r,[{key:"union",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"UNION";t=this._sanitizeTable(t),this._unions.push({type:e,table:t})}},{key:"union_all",value:function(t){this.union(t,"UNION ALL")}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._unions[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.type,c=u.table;e=y(e,this.options.separator);var f=void 0;if(c instanceof p.BaseBuilder){var h=c._toParamString({buildParameterized:t.buildParameterized,nested:!0});f=h.text,h.values.forEach(function(t){return r.push(t)})}else e=this._formatTableName(c);e+=s+" "+f}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return{text:e,values:r}}}]),r}(p.Block),p.QueryBuilder=function(t){function h(t,e){_(this,h);var o=v(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,t));o.blocks=e||[];var r=!0,n=!1,i=void 0;try{for(var l,a=o.blocks[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var u=l.value,s=u.exposedMethods();for(var c in s){var f=s[c];if(void 0!==o[c])throw new Error("Builder already has a builder method called: "+c);!function(n,t,i){o[0]=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.call.apply(i,[n].concat(e)),o}}(u,0,f)}}}catch(t){n=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}return o}return a(h,t),l(h,[{key:"registerValueHandler",value:function(t,e){var r=!0,n=!1,i=void 0;try{for(var o,l=this.blocks[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var a=o.value;a.registerValueHandler(t,e)}}catch(t){n=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(n)throw i}}return u(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"registerValueHandler",this).call(this,t,e),this}},{key:"updateOptions",value:function(t){this.options=c({},this.options,t);var e=!0,r=!1,n=void 0;try{for(var i,o=this.blocks[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var l=i.value;l.options=c({},l.options,t)}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}}},{key:"_toParamString",value:function(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r=c({},this.options,r);var t=this.blocks.map(function(t){return t._toParamString({buildParameterized:r.buildParameterized,queryBuilder:e})}),n=t.map(function(t){return t.text}),i=t.map(function(t){return t.values}),o=n.filter(function(t){return 0<t.length}).join(r.separator),l=[];if(i.forEach(function(t){return t.forEach(function(t){return l.push(t)})}),!r.nested&&r.numberedParameters){var a=void 0!==r.numberedParametersStartAt?r.numberedParametersStartAt:1,u=r.parameterCharacter.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=o.replace(new RegExp(u,"g"),function(){return""+r.numberedParametersPrefix+a++})}return{text:this._applyNestingFormatting(o,!!r.nested),values:l}}},{key:"clone",value:function(){var t=this.blocks.map(function(t){return t.clone()});return new this.constructor(this.options,t)}},{key:"getBlock",value:function(e){var t=this.blocks.filter(function(t){return t instanceof e});return t[0]}}]),h}(p.BaseBuilder),p.Select=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new p.StringBlock(t,"SELECT"),new p.FunctionBlock(t),new p.DistinctBlock(t),new p.GetFieldBlock(t),new p.FromTableBlock(t),new p.JoinBlock(t),new p.WhereBlock(t),new p.GroupByBlock(t),new p.HavingBlock(t),new p.OrderByBlock(t),new p.LimitBlock(t),new p.OffsetBlock(t),new p.UnionBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,t),r}(p.QueryBuilder),p.Update=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new p.StringBlock(t,"UPDATE"),new p.UpdateTableBlock(t),new p.SetFieldBlock(t),new p.WhereBlock(t),new p.OrderByBlock(t),new p.LimitBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,t),r}(p.QueryBuilder),p.Delete=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new p.StringBlock(t,"DELETE"),new p.TargetTableBlock(t),new p.FromTableBlock(c({},t,{singleTable:!0})),new p.JoinBlock(t),new p.WhereBlock(t),new p.OrderByBlock(t),new p.LimitBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,t),r}(p.QueryBuilder),p.Insert=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new p.StringBlock(t,"INSERT"),new p.IntoTableBlock(t),new p.InsertFieldValueBlock(t),new p.InsertFieldsFromQueryBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,t),r}(p.QueryBuilder);var e={VERSION:"5.13.0",flavour:t,expr:function(t){return new p.Expression(t)},case:function(t,e){return new p.Case(t,e)},select:function(t,e){return new p.Select(t,e)},update:function(t,e){return new p.Update(t,e)},insert:function(t,e){return new p.Insert(t,e)},delete:function(t,e){return new p.Delete(t,e)},str:function(){var t=new p.FunctionBlock;return t.function.apply(t,arguments),t},rstr:function(){var t=new p.FunctionBlock({rawNesting:!0});return t.function.apply(t,arguments),t},registerValueHandler:p.registerValueHandler};return e.remove=e.delete,e.cls=p,e}var h=s();return h.flavours={},h.useFlavour=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;if(!t)return h;if(h.flavours[t]instanceof Function){var e=s(t);return h.flavours[t].call(null,e),e.flavours=h.flavours,e.useFlavour=h.useFlavour,e}throw new Error("Flavour not available: "+t)},h.flavours.mssql=function(t){var o=t.cls;o.DefaultQueryBuilderOptions.replaceSingleQuotes=!0,o.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,o.DefaultQueryBuilderOptions.numberedParametersPrefix="@",t.registerValueHandler(Date,function(t){return"'"+t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds()+"'"}),o.MssqlLimitOffsetTopBlock=function(t){function e(t){_(this,e);var n=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n._limits=null,n._offsets=null;var i=function(t){t=this._sanitizeLimitOffset(t),this._parent._limits=t};return n.ParentBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t.options));return e._parent=t,e}return a(r,o.Block),r}(),n.LimitBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.limit=i,e}return a(r,n.ParentBlock),l(r,[{key:"_toParamString",value:function(){var t="";return this._parent._limits&&this._parent._offsets&&(t="FETCH NEXT "+this._parent._limits+" ROWS ONLY"),{text:t,values:[]}}}]),r}(),n.TopBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.top=i,e}return a(r,n.ParentBlock),l(r,[{key:"_toParamString",value:function(){var t="";return this._parent._limits&&!this._parent._offsets&&(t="TOP ("+this._parent._limits+")"),{text:t,values:[]}}}]),r}(),n.OffsetBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,n.ParentBlock),l(e,[{key:"offset",value:function(t){this._parent._offsets=this._sanitizeLimitOffset(t)}},{key:"_toParamString",value:function(){var t="";return this._parent._offsets&&(t="OFFSET "+this._parent._offsets+" ROWS"),{text:t,values:[]}}}]),e}(),n}return a(e,o.Block),l(e,[{key:"LIMIT",value:function(){return new this.LimitBlock(this)}},{key:"TOP",value:function(){return new this.TopBlock(this)}},{key:"OFFSET",value:function(){return new this.OffsetBlock(this)}}]),e}(),o.MssqlUpdateTopBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._limits=null,e.limit=e.top=function(t){e._limits=e._sanitizeLimitOffset(t)},e}return a(r,o.Block),l(r,[{key:"_toParamString",value:function(){return{text:this._limits?"TOP ("+this._limits+")":"",values:[]}}}]),r}(),o.MssqlInsertFieldValueBlock=function(t){function i(t){_(this,i);var e=v(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e._outputs=[],e}return a(i,o.InsertFieldValueBlock),l(i,[{key:"output",value:function(t){var e=this;"string"==typeof t?this._outputs.push("INSERTED."+this._sanitizeField(t)):t.forEach(function(t){e._outputs.push("INSERTED."+e._sanitizeField(t))})}},{key:"_toParamString",value:function(t){var e=u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"_toParamString",this).call(this,t);if(e.text.length&&0<this._outputs.length){var r="OUTPUT "+this._outputs.join(", ")+" ",n=e.text.indexOf("VALUES");e.text=e.text.substr(0,n)+r+e.text.substr(n)}return e}}]),i}(),o.MssqlUpdateDeleteOutputBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._outputs=[],e}return a(r,o.Block),l(r,[{key:"outputs",value:function(t){for(var e in t)this.output(e,t[e])}},{key:"output",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;t=this._sanitizeField(t),e=e?this._sanitizeFieldAlias(e):e,this._outputs.push({name:this.options.forDelete?"DELETED."+t:"INSERTED."+t,alias:e})}},{key:"_toParamString",value:function(t){var e="";if(this._outputs.length){var r=!0,n=!1,i=void 0;try{for(var o,l=this._outputs[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var a=o.value;e=y(e,", "),e+=a.name,a.alias&&(e+=" AS "+this._formatFieldAlias(a.alias))}}catch(t){n=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(n)throw i}}e="OUTPUT "+e}return{text:e,values:[]}}}]),r}(),o.Select=function(t){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_(this,n);var r=new o.MssqlLimitOffsetTopBlock(t);return e=e||[new o.StringBlock(t,"SELECT"),new o.DistinctBlock(t),r.TOP(),new o.GetFieldBlock(t),new o.FromTableBlock(t),new o.JoinBlock(t),new o.WhereBlock(t),new o.GroupByBlock(t),new o.OrderByBlock(t),r.OFFSET(),r.LIMIT(),new o.UnionBlock(t)],v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return a(n,o.QueryBuilder),n}(),o.Update=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new o.StringBlock(t,"UPDATE"),new o.MssqlUpdateTopBlock(t),new o.UpdateTableBlock(t),new o.SetFieldBlock(t),new o.MssqlUpdateDeleteOutputBlock(t),new o.WhereBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,o.QueryBuilder),r}(),o.Delete=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new o.StringBlock(t,"DELETE"),new o.TargetTableBlock(t),new o.FromTableBlock(c({},t,{singleTable:!0})),new o.JoinBlock(t),new o.MssqlUpdateDeleteOutputBlock(c({},t,{forDelete:!0})),new o.WhereBlock(t),new o.OrderByBlock(t),new o.LimitBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,o.QueryBuilder),r}(),o.Insert=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new o.StringBlock(t,"INSERT"),new o.IntoTableBlock(t),new o.MssqlInsertFieldValueBlock(t),new o.InsertFieldsFromQueryBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,o.QueryBuilder),r}()},h.flavours.mysql=function(t){var n=t.cls;n.MysqlOnDuplicateKeyUpdateBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,n.AbstractSetFieldBlock),l(e,[{key:"onDupUpdate",value:function(t,e,r){this._set(t,e,r)}},{key:"_toParamString",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=0;n<this._fields.length;++n){e=y(e,", ");var i=this._fields[n],o=this._values[0][n],l=this._valueOptions[0][n];if(void 0===o)e+=i;else{var a=this._buildString(i+" = "+this.options.parameterCharacter,[o],{buildParameterized:t.buildParameterized,formattingOptions:l});e+=a.text,a.values.forEach(function(t){return r.push(t)})}}return{text:e.length?"ON DUPLICATE KEY UPDATE "+e:"",values:r}}}]),e}(),n.Insert=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.StringBlock(t,"INSERT"),new n.IntoTableBlock(t),new n.InsertFieldValueBlock(t),new n.InsertFieldsFromQueryBlock(t),new n.MysqlOnDuplicateKeyUpdateBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}(),n.Replace=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.StringBlock(t,"REPLACE"),new n.IntoTableBlock(t),new n.InsertFieldValueBlock(t),new n.InsertFieldsFromQueryBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}(),t.replace=function(t,e){return new n.Replace(t,e)}},h.flavours.postgres=function(t){var n=t.cls;n.DefaultQueryBuilderOptions.numberedParameters=!0,n.DefaultQueryBuilderOptions.numberedParametersStartAt=1,n.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,n.DefaultQueryBuilderOptions.useAsForTableAliasNames=!0,n.PostgresOnConflictKeyUpdateBlock=function(t){function e(){return _(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,n.AbstractSetFieldBlock),l(e,[{key:"onConflict",value:function(t,e){var r=this;this._onConflict=!0,t&&(d(t)||(t=[t]),this._dupFields=t.map(this._sanitizeField.bind(this)),e&&Object.keys(e).forEach(function(t){r._set(t,e[t])}))}},{key:"_toParamString",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="",r=[],n=0;n<this._fields.length;++n){e=y(e,", ");var i=this._fields[n],o=this._values[0][n],l=this._valueOptions[0][n];if(void 0===o)e+=i;else{var a=this._buildString(i+" = "+this.options.parameterCharacter,[o],{buildParameterized:t.buildParameterized,formattingOptions:l});e+=a.text,a.values.forEach(function(t){return r.push(t)})}}var u={text:"",values:r};if(this._onConflict){var s=this._dupFields?"("+this._dupFields.join(", ")+") ":"",c=e.length?"UPDATE SET "+e:"NOTHING";u.text="ON CONFLICT "+s+"DO "+c}return u}}]),e}(),n.ReturningBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._fields=[],e}return a(r,n.Block),l(r,[{key:"returning",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(r=r?this._sanitizeFieldAlias(r):r,e=this._sanitizeField(e),this._fields.filter(function(t){return t.name===e&&t.alias===r}).length)return this;this._fields.push({name:e,alias:r,options:t})}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(t.queryBuilder,t.buildParameterized),r="",n=[],i=!0,o=!1,l=void 0;try{for(var a,u=this._fields[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var s=a.value;r=y(r,", ");var c=s.name,f=s.alias,h=s.options;if("string"==typeof c)r+=this._formatFieldName(c,h);else{var v=c._toParamString({nested:!0,buildParameterized:e});r+=v.text,v.values.forEach(function(t){return n.push(t)})}f&&(r+=" AS "+this._formatFieldAlias(f))}}catch(t){o=!0,l=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw l}}return{text:0<r.length?"RETURNING "+r:"",values:n}}}]),r}(),n.WithBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._tables=[],e}return a(r,n.Block),l(r,[{key:"with",value:function(t,e){this._tables.push({alias:t,table:e})}},{key:"_toParamString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=[],r=[],n=!0,i=!1,o=void 0;try{for(var l,a=this._tables[Symbol.iterator]();!(n=(l=a.next()).done);n=!0){var u=l.value,s=u.alias,c=u.table._toParamString({buildParameterized:t.buildParameterized,nested:!0});e.push(s+" AS "+c.text),c.values.forEach(function(t){return r.push(t)})}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return{text:e.length?"WITH "+e.join(", "):"",values:r}}}]),r}(),n.DistinctOnBlock=function(t){function r(t){_(this,r);var e=v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e._distinctFields=[],e}return a(r,n.Block),l(r,[{key:"distinct",value:function(){var e=this;this._useDistinct=!0;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){e._distinctFields.push(e._sanitizeField(t))})}},{key:"_toParamString",value:function(){var t="";return this._useDistinct&&(t="DISTINCT",this._distinctFields.length&&(t+=" ON ("+this._distinctFields.join(", ")+")")),{text:t,values:[]}}}]),r}(),n.Select=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.WithBlock(t),new n.StringBlock(t,"SELECT"),new n.FunctionBlock(t),new n.DistinctOnBlock(t),new n.GetFieldBlock(t),new n.FromTableBlock(t),new n.JoinBlock(t),new n.WhereBlock(t),new n.GroupByBlock(t),new n.HavingBlock(t),new n.OrderByBlock(t),new n.LimitBlock(t),new n.OffsetBlock(t),new n.UnionBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}(),n.Insert=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.WithBlock(t),new n.StringBlock(t,"INSERT"),new n.IntoTableBlock(t),new n.InsertFieldValueBlock(t),new n.InsertFieldsFromQueryBlock(t),new n.PostgresOnConflictKeyUpdateBlock(t),new n.ReturningBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}(),n.Update=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.WithBlock(t),new n.StringBlock(t,"UPDATE"),new n.UpdateTableBlock(t),new n.SetFieldBlock(t),new n.FromTableBlock(t),new n.WhereBlock(t),new n.OrderByBlock(t),new n.LimitBlock(t),new n.ReturningBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}(),n.Delete=function(t){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return _(this,r),e=e||[new n.WithBlock(t),new n.StringBlock(t,"DELETE"),new n.TargetTableBlock(t),new n.FromTableBlock(c({},t,{singleTable:!0})),new n.JoinBlock(t),new n.WhereBlock(t),new n.OrderByBlock(t),new n.LimitBlock(t),new n.ReturningBlock(t)],v(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return a(r,n.QueryBuilder),r}()},h})?n.apply(e,i):n)||(t.exports=o)}}]);